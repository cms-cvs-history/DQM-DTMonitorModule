process MONITOR = {
        include "CondCore/DBCommon/data/CondDBSetup.cfi"

############################################################################################	
##        #Mapping
############################################################################################
es_source roMapping = PoolDBESSource {
    using CondDBSetup
    string connect = 
"sqlite_file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite/TestYB-1/channelsMap_new/mapWh-1.db"
#"sqlite_file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite/TestYB2/channelsMap/mapWh2.db"

    untracked string catalog =
"file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite/TestYB-1/channelsMap_new/mapWh-1.xml"
#"file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite/TestYB2/channelsMap/mapWh2.xml"
    string timetype = "runnumber"  
    untracked uint32 authenticationMethod = 0
    VPSet toGet = {{
            string record = "DTReadOutMappingRcd"
            string tag = "channelsMap"
        }}
            untracked bool debug = false
            untracked bool   debugFlag     = false
            untracked uint32 debugVebosity = 10
       }

############################################################################################
#      # Event Formatter
############################################################################################
      source = DaqSource{ 
        untracked string readerPluginName = "DTDDUFileReader"
        untracked PSet readerPset = {
               untracked string fileName	      
 ="rfio:/castor/cern.ch/user/d/dtdqm/YB-1/DT_Wm1S01S02S06S07S08S12_ALL_HanyT_Tech_vmepcs2g18-16_r32184.i0"
	        untracked bool isRaw = true   
                untracked int32 numberOfHeaderWords = 10 		
                untracked int32 eventsAnalysisRate = 1
                    }
        }
  untracked PSet maxEvents = {
    untracked int32 input = 10000
  }


############################################################################################
#   Unpacker            
############################################################################################
    module dtunpacker = DTUnpackingModule{
      string dataType = "DDU"
      #              string dataType = "ROS25"
   
      PSet readOutParameters  = {
        untracked bool localDAQ = true ## New version
        untracked bool performDataIntegrityMonitor = false
        untracked bool debug = false ## New version

        PSet rosParameters = {
           untracked bool localDAQ = true ## New version
           untracked bool isRaw = true
           untracked bool readingDDU = true
           untracked bool writeSC = false  ## "oficial" SC collection
           untracked bool readDDUIDfromDDU=false 
           untracked int32 dduID = 770
           untracked bool performDataIntegrityMonitor = true
           untracked bool debug = false ## New version

        }
      }
    }

#            untracked bool globalDAQ = false

############################################################################################		
## Minimal Message logger
############################################################################################
      service = MessageLogger {
      untracked vstring destinations = { "cout" }
#      untracked PSet cout = { untracked string threshold = "INFO" }
      untracked PSet cout = { untracked string threshold = "ERROR" }
 }
 
############################################################################################	
	#DQM technicalities
############################################################################################
	service = DaqMonitorROOTBackEnd{ }
	
        service = DTDataIntegrityTask{
		#untracked string outputFile = "test.root"
  		untracked bool debug = false
		untracked int32 timeBoxLowerBound = 2500
		untracked int32 timeBoxUpperBound = 8500
                #untracked int32 saveResultsFrequency = 1000
        	untracked int32 nTimeBin = 1000
        	untracked bool doTimeHisto = true
	untracked bool writeHisto = true
		}


        service = MonitorDaemon{
       # if true, will automatically start DQM thread in background
       # (default: false)
        untracked bool AutoInstantiate = false
        #untracked string DestinationAddress = "localhost"
        #untracked int32 SendPort = 9090
        #untracked int32 UpdateDelay = 1000
        #untracked string NameAsSource = "FU0"        
	
	# if true, will automatically start DQM thread in background
        untracked bool AutoInstantiate=false

        # if >=0, upon a connection problem, the source will automatically
        # attempt to reconnect with a time delay (secs) specified here
        # (default: 5)
        untracked int32 reconnect_delay = 5

        # collector hostname; examples:localhost(default),lxcmse2.cern.ch, etc
        #untracked string DestinationAddress = "lxplus008.cern.ch"
	untracked string DestinationAddress = "localhost"	

        # port for communicating with collector (default: 9090)
        untracked int32 SendPort = 9090

        # monitoring period in ms (i.e. how often monitoring elements
        # are shipped to the collector; default: 1000)
        untracked int32 UpdateDelay = 3000

        # name of DQM source (default: DQMSource)
        untracked string NameAsSource = "FU0"
        }

        module out = PoolOutputModule {
               untracked string fileName ="dtdigi.root"
        }


	path p = {dtunpacker}	

}
