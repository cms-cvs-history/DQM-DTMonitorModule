process MONITOR = {    


# how the config should be:
# Missing:
# 1) file sqlLite di singola camera con rispettivi cataloghi
# 2) gestione input/output file 

	# Mapping 
	es_source = PoolDBESSource { VPSet toGet = {
					  { string record = "DTReadOutMappingRcd" 
        	                            string tag = "COMMISSIONING_MB1_COMMISSIONING_MB1" }
                                                   }
		    		     bool loadAll = true
                                     string connect = "sqlite_file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite/commissioning/mb1.db"
				     untracked string catalog = "file:/afs/cern.ch/cms/Physics/muon/CMSSW/DT/SQLLite/commissioning/mb1catalog.xml"
			             string timetype = "runnumber" 
				   }
	# Geometry
 	es_source = XMLIdealGeometryESSource {
			FileInPath GeometryConfiguration="/afs/cern.ch/cms/Physics/muon/CMSSW/DT/Geometry/DQMConfiguration.xml"
		 	string rootNodeName = "cms:CMSE"
		     }
	es_module = DTGeometryESModule { }


	# Event Formatter
	source = DaqSource{ string reader = "DTROS8FileReader"
	   			untracked int32 maxEvents = -1
				PSet pset = { string fileName ="input.raw" } 
	}
	
	# Data Unpacker
	module dtunpacker = DTUnpackingModule{ 
		string dataType = "ROS8" }
	

	# DT Digi DQM
	module dtMonitor = DTDigiTask{
		untracked string outputFile = "nomeRunSources.root"
		untracked bool performPerWireT0Calibration = false
		int32 defaultTtrig = 1000
		int32 defaultTmax = 400
		untracked int32 timeBoxGranularity = 1
		int32 inTimeHitsLowerBound = 30
		int32 inTimeHitsUpperBound = 50
	}
	
	path p = {dtunpacker, dtMonitor}	


	#DQM technicalities
	service = DaqMonitorROOTBackEnd{ }
	
	service = MonitorDaemon{
	  # if true, will automatically start DQM thread in background
	  # (default: false)
	  untracked bool AutoInstantiate = true
	
	  # if >=0, upon a connection problem, the source will automatically 
	  # attempt to reconnect with a time delay (secs) specified here 
	  # (default: 5)
	  untracked int32 reconnect_delay = 5
	
	  # collector hostname
	  # (default: localhost)
	  untracked string DestinationAddress = "localhost"
	
	  # port for communicating with collector
	  # (default: 9090)
	  untracked int32 SendPort = 9090
	
	  # monitoring period in ms (i.e. how often monitoring elements 
	  # are shipped to the collector
	  # (default: 1000)
	  untracked int32 UpdateDelay = 1000
	
	  # name of DQM source
	  # (default: DQMSource)
	  untracked string NameAsSource = "FU0"
	}

}

